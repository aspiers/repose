<?xml version="1.0" encoding="UTF-8"?>
<web-app version="3.0" xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
    
    <display-name>Repose Root Web Application</display-name>
    <description>Proxies for fun</description>
        
    <!-- This tells Power API where to look for its configurations -->
    <context-param>
        <param-name>powerapi-config-directory</param-name>
        <param-value>/etc/repose</param-value>
    </context-param>
    <context-param>
        <param-name>repose-cluster-id</param-name>
        <param-value>repose</param-value>
    </context-param>
    
    <context-param>
        <param-name>repose-node-id</param-name>
        <param-value>repose_node1</param-value>
    </context-param>
    
    <listener>
        <display-name>Spring Context Loader Listener</display-name>
        <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
    </listener>

    <!-- Servlets -->
    <servlet id="power-api-servlet">
        <servlet-name>empty-servlet</servlet-name>
        <servlet-class>com.rackspace.papi.EmptyServlet</servlet-class>
    </servlet>
    
    <servlet-mapping id="power-api-servlet-mapping">
        <servlet-name>empty-servlet</servlet-name>
        <url-pattern>/*</url-pattern>
    </servlet-mapping>

    <!-- Filters -->
    <!-- using the advice from:
    http://docs.spring.io/spring/docs/3.0.x/javadoc-api/org/springframework/web/filter/DelegatingFilterProxy.html
    Specifically: web.xml will usually contain a DelegatingFilterProxy definition, with the specified filter-name
    corresponding to a bean name in Spring's root application context. All calls to the filter proxy will then be
    delegated to that bean in the Spring context, which is required to implement the standard Servlet 2.3 Filter
    interface.
    -->
    <filter id="power-api-filter">
        <filter-name>powerFilter</filter-name>
        <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
    </filter>
    
    <filter-mapping id="powerFilter-mapping">
        <filter-name>powerFilter</filter-name>
        <url-pattern>/*</url-pattern>
    </filter-mapping>
</web-app>
